
<div class="container mt-5">
  <div>
    <div>
      <button class="btn btn-danger" (click)="goBackToFilter()">Go back</button>
    </div>
  </div>

</div>
<div class="container">
  <div class="loading-container" *ngIf="uploading || fetching || loading || ExportingExcel">
    <div class="upload-animation text-center">
      <i class="fa fa-spinner fa-spin fa-3x" [ngStyle]="{'color': uploading || fetching ? 'rgb(255, 141, 12)' : 'rgb(12, 255, 32)'}"></i>
      <p class="upload-text" [ngStyle]="{'color': loading ? 'greenyellow' : 'rgb(255, 155, 5)'}">
        {{ uploading ? 'Uploading...' : (fetching ? 'Fetching...' : (loading ? 'Loading...' : 'Exporting...')) }}
      </p>
      <img *ngIf="ExportingExcel" src="/assets/images/export.GIF.gif" style="width: 100px; height: 100px" alt="exportImage" />
    </div>
  </div>

  <div class="row mt-3">
    <div class="col-md-4">
      <div class="text-center">
        <select name="" id="" (change)="selectYear($event)" class="form-control">
          <option value="">--Select Year--</option>
          <option *ngFor="let year of years" [value]="year">{{ year }}</option>
        </select>
      </div>
    </div>
    <div class="col-md-4">
      <div class="text-center">
        <select name="" id="" (change)="selectSection($event)" class="form-control">
          <option value="">--Select code--</option>
      
            <ng-container *ngFor="let innerArray of ArrayOfSections">
              <option [value]="innerArray">{{innerArray}}</option>
      
           
            </ng-container>
         
        </select>




      </div>
    </div>
    <div class="col-md-4">
      <div class="text-center">
        <label for="file-upload" class="custom-file-upload">
          <i class="fa fa-cloud-upload"></i> Choose File
          <p id="file-name" *ngIf="fileNameinitalStae">{{ fileName }}</p>
        </label>&nbsp; &nbsp;
        <button class="btn btn-success" [style.background-color]="buttonbgColor" [style.color]="buttonColor" (click)="onUpload()">Upload</button>
        <input id="file-upload" type="file" style="display: none" (change)="onFileSelected($event)" />
        <div *ngIf="uploadSuccess" style="position: absolute; top: 42px; left: 46%;">
          {{ uploadMessage }}
          <i *ngIf="uploadSuccess" class="fa fa-check-circle" aria-hidden="true" style="color: green; font-size: 20px"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="container text-center mt-4">
    <p *ngIf="isrecordsCount"> Your Selected Records count is <span>{{ recordsCount }}</span></p>
  </div>
</div>
